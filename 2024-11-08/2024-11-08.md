# WAN

<aside>
✏️

3계층

3계층의 기능

: 서로 다른 LAN을 연결시켜주는 것, 멀리 떨어진 곳에 존재하는 네트워크까지 어떻게 데이터를 전달할지 제어하는 일을 담당한다

3계층에서 사용하는 주소

: IP주소, 멀리 있는 네트워크 대역과 통신하기 위해서는 MAC 주소 뿐만 아니라 IP 주소도 가지고 있어야 한다. 서브넷 마스크, 게이트웨이 등이 추가적으로 필요하다.

- IPv4 : 현재 PC에 할당된 IP 주소
- 서브넷 마스크 : IP 주소에 대한 네트워크의 대역을 규정하는 것
- 게이트웨이 주소 : 외부와 통신할 때 사용하는 네트워크의 출입구

3계층 프로토콜

- IP 주소를 이용해 MAC 주소를 알아오는 ARP 프로토콜
- WAN에서 통신할 때 사용하는 IPv4 프로토콜
- 서로가 통신되는지 확인할 때 사용하는 ICMP 프로토콜

IP

: HOST에 대한 식별자

- IPv4 : 32bit
- IPv6 : 128bit

IP의 구조

: IP주소는 8bit씩 끊어서 표시한다

IP Header format

- version: IPv4인지 IPv6인지 나눈다. 다만, IPv4와 IPv6 프로토콜 헤더의 모양새가 완전히 다르다.
- IHL: Internet Header Length: 보통은 5이다. (5 * 4byte(32bit) = 20byte(Header의 길이)) 만약 option이 있다면 더 길어질 수 있음.
- TOS(Type of Service)
- TTL(Time To Live): router를 지나갈 때 마다 TTL 이 1씩 감소(2^8 = 255) 255번 지나고 나면 TTL의 값이 0이 되는데, 이 때는 router가 패킷을 버려버림.
- protocol: 4계층의 헤더 값을 가리킴
- Header checksum: 전송간의 오류가 있는지 없는지 확인
- Source address
- Destination address

Classful IP주소

: Class 별로 IP주소를 나눠서 사용한다. 사용할 수 있는 범위가 정해져있다.

- A 클래스의 첫번째 필드만 네트워크 대역을 구분, 그 이후 필드는 각개의 PC를 구분
- B 클래스의 두번쨰 필드까지 네트워크 대역을 구분, 그 이후 필드는 각개의 PC를 구분
- C 클래스의 세번째 필드까지 네트워크 대역을 구분, 마지막 필드는 각개의 PC를 구분
- D 클래스는 멀티캐스트를 위해 남겨둔 주소
- E 클래스는 연구용으로 남겨둔 IP 주소

ClassFulless

: 하나의 큰 네트워크를 여러개의 작은 네트워크로 쪼개서 사용

- 어디까지가 네트워크 대역을 구분하는 곳이고 그 이후 필드는 네트워크 대역에 속해있는 PC들을 구분하는 값인지 지정
- 이진수로 표기했을 때 1로 시작하고, 1과 1 사이에는 0이 올 수 없다는 규칙이 있다. 즉, 연속된 1로 구성되어있으며, 0이 한번 나오면 그 뒤는 전부 0이어야함
- 서브넷 마스크를 이용해서 하나의 큰 네트워크 대역을 잘게 쪼개는 것을 서브넷팅이라고 함
- 쪼개진 네트워크 대역을 하나로 합치는 것을 슈퍼넷팅이라고 함

특수한 IP 주소

- 0.0.0.0 : 나머지 모든 IP
- 127.x.x.x : 자기 자신을 나타내는 주소

게이트웨이 주소

: 일반적으로 공유기의 IP, 사설 IP에서 외부로 나갈 때 무조건 공유기를 통해서 나가는데 외부 세상으로 나가는 문 같은 개념

router

: 패킷 단위의 데이터가 router에 도착하면 경로 선택 switching을 하는데, 그 중 최적화된 경로를 통해 목적지에 간다. 그 때 이정표 역할처럼 근거가 되는 것이 routing table이다.

서브넷팅

: IP 주소 낭비를 방지하기 위해 원본 네트워크를 여러개의 서브넷으로 분리하는 과정

</aside>